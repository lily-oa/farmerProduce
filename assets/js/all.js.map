{"version":3,"sources":["all.js"],"names":["url","productList","document","querySelector","btnGroup","btnCropsType","querySelectorAll","inputTxt","inputBtn","resultName","selectList","tableSortGroup","form","data","filterData","currentSearch","getData","axios","get","then","response","filter","item","作物名稱","init","innerHTML","addEventListener","searchCrops","searchCropsKey","filterCropType","sortTableBytitle","selectListAll","formSubmit","e","preventDefault","value","vale","update","forEach","index","changeSelect","showData","str","content","市場名稱","上價","中價","下價","平均價","交易量","target","nodeName","classList","remove","add","type","dataset","種類代碼","textContent","resetSelect","match","trim","length","key","sortChange","sort","a","b","sortTitle","title","sortDirection"],"mappings":"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","file":"all.js","sourcesContent":["const url = \"https://hexschool.github.io/js-filter-data/data.json\";\nconst productList = document.querySelector('.show-list');\nconst btnGroup = document.querySelector('.btn-group');\nconst btnCropsType = document.querySelectorAll('.btn-group a');  //共三顆按鈕要用\"querySelectorAll\nconst inputTxt = document.querySelector('.input-txt');\nconst inputBtn = document.querySelector('.input-btn');\nconst resultName = document.querySelector('.result-name');\nconst selectList = document.querySelectorAll('.select-group'); //querySelectorAll \nconst tableSortGroup = document.querySelector('.table-title');\n// Search lists by input\nconst form = document.querySelector('.formSubmit');\n\nlet data;\nlet filterData = [];\nlet currentSearch = '';\n\n\n//---- axios撈取資料 ---- //\nfunction getData(){\n  axios.get(url)\n  .then(function(response){\n    data = response.data.filter(item => item.作物名稱);\n    // console.log(data);\n    init(); //非同步\n  });\n}\n\n// 預設渲染畫面  初始值\nfunction init(){\n  productList.innerHTML = `\n  <tr class=\"table-waiting\">\n    <td colspan=\"7\">請輸入並搜尋想比價的作物名稱^_^</td>\n  </tr>`;\n\n  inputBtn.addEventListener('click', searchCrops, false);\n  inputTxt.addEventListener('keyup', searchCropsKey, false );  //鍵盤搜尋\n  btnGroup.addEventListener('click', filterCropType, false);   //按鈕分類篩選資料\n  tableSortGroup.addEventListener('click', sortTableBytitle, false); //nav上的按鈕功能\n  selectListAll();\n  form.addEventListener('submit', formSubmit, false);\n}\n\n\n\n// Search lists by input \n  function formSubmit(e){\n    e.preventDefault();\n    if(inputTxt.value === ''){\n      currentSearch = '';\n      return;\n    }else{\n    currentSearch = inputTxt.vale;\n    searchCrops();\n    update(filterData);\n    }\n  }\n\n//select pc mobile 兩個下拉選單監聽事件\nfunction selectListAll(){\n  selectList.forEach(function(item, index){\n    selectList[index].addEventListener('change', changeSelect, false);\n  });\n}\n\ngetData();\n\n// 更新渲染畫面使用\nfunction update(showData) {\n\n  let str = '';\n  showData.forEach(function(item){\n    let content = `\n      <tr>\n        <td>${item.作物名稱}</td>\n        <td>${item.市場名稱}</td>\n        <td>${item.上價}</td>\n        <td>${item.中價}</td>\n        <td>${item.下價}</td>\n        <td>${item.平均價}</td>\n        <td>${item.交易量}</td>\n      </tr>\n    `;\n    str += content;\n  });\n  productList.innerHTML = str;\n}\n\n// 按鈕分類篩選資料\nfunction filterCropType(e){\n  e.preventDefault();\n  if(e.target.nodeName !== 'A'){\n    return;\n  };\n\n  btnCropsType.forEach(item =>{\n    item.classList.remove('active');\n    e.target.classList.add('active');\n  });\n\n  let type = e.target.dataset.type;\n  filterData = data.filter(item => type === item.種類代碼);\n\n  resultName.textContent = e.target.textContent;\n  resetSelect();\n  update(filterData);\n}\n\n// 搜尋資料\nfunction searchCrops(e){\n  filterData = data.filter((item) => item.作物名稱.match(inputTxt.value.trim()));\n  filterData = data.filter((item) => {\n    if(item.作物名稱 === null){\n      return false;\n    }else{\n      return item.作物名稱.match(inputTxt.value);\n    }\n  });\n\n  if(inputTxt.value.trim() !== \"\"){\n    inputBtn.classList.add('btn-active');\n  }else{\n    return;\n  }\n\n  // 過濾輸入值的空白\n  filterData = data.filter((item) => item.作物名稱.match(inputTxt.value.trim()));\n  btnCropsType.forEach(item => item.classList.remove('active'));\n\n  resultName.textContent = inputTxt.value.trim();\n  inputTxt.value = '';\n  inputBtn.classList.remove('btn-active');\n  resetSelect();\n\n  if(filterData.length === 0){\n    let content = `<tr class=\"table-waiting\"><td colspan=\"7\">查詢不到交易資訊</td></tr>`;\n    productList.innerHTML = content;\n    return;\n  };\n  update(filterData);\n}\n\n//鍵盤搜尋事件\n  function searchCropsKey(e){\n    if(inputTxt.value.trim() ==''){\n      return;\n    };\n    inputBtn.classList.add('btn-active');\n    if(e.key === 'Enter'){\n      searchCrops(e);\n    };\n  }\n\n// select change 下拉選單\nfunction changeSelect(e){\n  if(filterData.length == 0){\n    return;\n  }\n  switch (e.target.value) {\n    case '依上價排序':\n      sortChange('上價');\n      break;\n    case '依中價排序':\n      sortChange('中價');\n      break;\n    case '依下價排序':\n      sortChange('下價');\n      break;\n    case '依平均價排序':\n      sortChange('平均價');\n      break;\n    case '依交易量排序':\n      sortChange('交易量');\n      break;      \n  }\n}\n\n// select change 下拉選單 \nfunction sortChange(e){\n  filterData.sort((a, b) => a[e]-b[e]);\n  update(filterData);\n}\n\n// 進階篩選 表單內排序\nfunction sortTableBytitle(e){\n  if(e.target.nodeName !== 'I'){\n    return;\n  }else{\n    let sortTitle = e.target.dataset.title;\n    let sortDirection = e.target.dataset.sort;\n    \n    if(sortDirection === 'up'){\n      filterData.sort((a, b) => b[sortTitle] - a[sortTitle]);\n    }else if(sortDirection === 'down'){\n      filterData.sort((a, b) => a[sortTitle] - b[sortTitle]);\n    };\n\n    selectList.forEach(function(item, index){\n      selectList[index].value = `依${sortTitle}排序`;\n    });\n    update(filterData);\n  }\n}\n\n// 清空下拉選單\nfunction resetSelect() {\n  selectList[0].value = '排序篩選';\n  selectList[1].value = '排序';\n}\n\n"]}